<!doctype html>
<html lang="uk">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>SHOP.UA</title>
<style>
:root{--main:#ff4757;--dark:#2f3542;--light:#f1f2f6}
body{font-family:Segoe UI,sans-serif;background:var(--light);margin:0;padding-bottom:50px;overflow-x:hidden}
.top-order{text-align:center;padding:8px;background:#fff;font-size:13px;border-bottom:1px solid #eee}
.top-order a{color:var(--main);text-decoration:none;font-weight:bold}
header{background:white;padding:15px;text-align:center;box-shadow:0 2px 10px rgba(0,0,0,.1);position:sticky;top:0;z-index:100}
.plus-btn{position:absolute;right:20px;top:15px;font-size:24px;cursor:pointer;color:var(--main)}
.controls{padding:15px;display:flex;flex-direction:column;gap:10px}
input,button{padding:12px;border-radius:10px;border:1px solid #ddd;outline:none;font-size:14px}
.catalog{display:grid;grid-template-columns:1fr 1fr;gap:12px;padding:12px}
.item-card{background:white;border-radius:15px;padding:10px;box-shadow:0 4px 6px rgba(0,0,0,.05);position:relative}
.item-card img{width:100%;height:150px;object-fit:cover;border-radius:10px;background:#eee}
.item-price{color:var(--main);font-weight:bold;font-size:18px;margin:5px 0}
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.7);z-index:1000;justify-content:center;align-items:center}
.modal.show{display:flex}
.modal-content{background:white;width:90%;max-width:380px;padding:20px;border-radius:15px;display:flex;flex-direction:column;gap:10px}
.save-btn{background:#2ecc71;color:white;border:none;font-weight:bold;cursor:pointer}
#loadingOverlay{display:none;color:var(--main);font-weight:bold;text-align:center;font-size:14px}
.del-btn{position:absolute;top:5px;right:5px;background:red;color:white;border:none;border-radius:5px;padding:2px 6px;z-index:10}
</style>
</head>
<body>

<div class="top-order">–∑–∞–º–æ–≤–∏—Ç–∏üëá<br><a href="tel:+380XXXXXXXXX">+380XXXXXXXXX</a></div>

<header>
  <h1 style="margin:0;font-size:20px">BRAND-NAME.UA</h1>
  <div class="plus-btn" id="openAdminBtn">+</div>
</header>

<div class="controls">
  <input type="text" id="searchInput" placeholder="–ü–æ—à—É–∫...">
</div>

<div class="catalog" id="catalog"></div>

<div id="adminModal" class="modal">
  <div class="modal-content" id="authBox">
    <h3 style="margin:0">–í—Ö—ñ–¥</h3>
    <input type="password" id="authCode" placeholder="–ö–æ–¥ (xxxshop)">
    <button class="save-btn" id="confirmAuthBtn">–£–≤—ñ–π—Ç–∏</button>
  </div>
  
  <div class="modal-content" id="addBox" style="display:none">
    <h3 style="margin:0">–ù–æ–≤–∏–π —Ç–æ–≤–∞—Ä</h3>
    <input type="text" id="pTitle" placeholder="–ù–∞–∑–≤–∞">
    <input type="number" id="pPrice" placeholder="–¶—ñ–Ω–∞">
    <label style="font-size:12px;color:#666">–§–æ—Ç–æ –∑ –≥–∞–ª–µ—Ä–µ—ó:</label>
    <input type="file" id="pImgFile" accept="image/*">
    <div id="loadingOverlay">‚è≥ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–æ—Ç–æ –≤ —Ö–º–∞—Ä—É...</div>
    <button class="save-btn" id="addProductBtn">üöÄ –ó–±–µ—Ä–µ–≥—Ç–∏ —Ç–æ–≤–∞—Ä</button>
    <button style="background:#888;color:white;border:none;padding:10px;border-radius:10px" onclick="document.getElementById('adminModal').classList.remove('show')">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
import { getDatabase, ref, push, set, onValue, remove } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyD3BQTZeCp74owFliqECbUgufJ3UC6dFC8",
  authDomain: "vip-shop-a2ec4.firebaseapp.com",
  projectId: "vip-shop-a2ec4",
  databaseURL: "https://vip-shop-a2ec4-default-rtdb.firebaseio.com",
  appId: "1:429877342673:web:bf2fbcddd5f3ba04c670f0"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const productsRef = ref(db, 'products');

let isAdmin = false;
let allProducts = [];
const IMGBB_KEY = '03c26bf2c4e95bbd1e544d9d2cad9672'; // –¢–≤—ñ–π –∫–ª—é—á –≤—Å—Ç–∞–≤–ª–µ–Ω–æ!

window.del = (id) => { if(confirm('–í–∏–¥–∞–ª–∏—Ç–∏?')) remove(ref(db, 'products/' + id)); };

const render = (prods) => {
  const c = document.getElementById('catalog');
  c.innerHTML = '';
  prods.forEach(p => {
    const div = document.createElement('div');
    div.className = 'item-card';
    div.innerHTML = `
      ${isAdmin ? `<button class="del-btn" onclick="del('${p.id}')">‚úï</button>` : ''}
      <img src="${p.img}" onerror="this.src='https://via.placeholder.com/150'">
      <div class="item-price">${p.price} –≥—Ä–Ω</div>
      <div style="font-size:14px;color:#333">${p.title}</div>
      <div style="font-size:10px;color:#999;margin-top:4px">ID: ${p.id.substring(1,7).toUpperCase()}</div>
    `;
    c.appendChild(div);
  });
};

onValue(productsRef, (snap) => {
  const data = snap.val();
  allProducts = data ? Object.keys(data).map(id => ({ id, ...data[id] })) : [];
  render(allProducts);
});

document.getElementById('openAdminBtn').onclick = () => document.getElementById('adminModal').classList.add('show');

document.getElementById('confirmAuthBtn').onclick = () => {
  if (document.getElementById('authCode').value === 'xxxshop') {
    isAdmin = true;
    document.getElementById('authBox').style.display = 'none';
    document.getElementById('addBox').style.display = 'flex';
    render(allProducts);
  } else { alert('–•–∏–±–Ω–∏–π –∫–æ–¥!'); }
};

document.getElementById('addProductBtn').onclick = async () => {
  const title = document.getElementById('pTitle').value;
  const price = document.getElementById('pPrice').value;
  const fileInput = document.getElementById('pImgFile');
  
  if (!title || !price || !fileInput.files[0]) return alert('–ó–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è —Ç–∞ –≤–∏–±–µ—Ä—ñ—Ç—å —Ñ–æ—Ç–æ!');

  document.getElementById('loadingOverlay').style.display = 'block';
  document.getElementById('addProductBtn').disabled = true;

  const formData = new FormData();
  formData.append('image', fileInput.files[0]);

  try {
    const resp = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_KEY}`, {
      method: 'POST',
      body: formData
    });
    const resData = await resp.json();
    
    if (resData.success) {
      const imgUrl = resData.data.url;
      set(push(productsRef), { title, price, img: imgUrl });
      document.getElementById('adminModal').classList.remove('show');
      document.getElementById('pTitle').value = ''; 
      document.getElementById('pPrice').value = '';
      document.getElementById('pImgFile').value = '';
    } else {
      alert('–ü–æ–º–∏–ª–∫–∞ ImgBB: ' + resData.error.message);
    }
  } catch (e) {
    alert('–ü–æ–º–∏–ª–∫–∞ –º–µ—Ä–µ–∂—ñ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Ñ–æ—Ç–æ');
  } finally {
    document.getElementById('loadingOverlay').style.display = 'none';
    document.getElementById('addProductBtn').disabled = false;
  }
};

document.getElementById('searchInput').oninput = (e) => {
  const q = e.target.value.toLowerCase().trim();
  render(allProducts.filter(p => p.title.toLowerCase().includes(q) || p.id.toLowerCase().includes(q)));
};
</script>
</body>
</html>
 

