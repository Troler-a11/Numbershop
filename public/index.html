<!doctype html>
<html lang="uk">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>SHOP-NAME.UA</title>
<style>
:root{--main:#ff4757;--dark:#2f3542;--light:#f1f2f6;--gold:#ffd700;--gray:#888}
body{font-family:'Segoe UI',sans-serif;background:var(--light);margin:0;padding-bottom:50px}

/* –í–µ—Ä—Ö–Ω—ñ–π –Ω–æ–º–µ—Ä */
.top-contact{background:#fff;text-align:center;padding:5px;font-size:14px;border-bottom:1px solid #eee}
.top-contact a{color:var(--main);text-decoration:none;font-weight:bold}

header{background:#fff;padding:15px;text-align:center;box-shadow:0 2px 5px rgba(0,0,0,.1);position:sticky;top:0;z-index:100}
.plus-btn{position:absolute;right:20px;top:15px;font-size:24px;cursor:pointer;color:var(--main)}

.controls{padding:10px;display:flex;flex-direction:column;gap:8px}
.filters{display:flex;gap:5px;overflow-x:auto;padding:5px 0}
.f-btn{background:#fff;border:1px solid var(--main);padding:6px 12px;border-radius:20px;white-space:nowrap;font-size:12px;cursor:pointer;color:var(--main)}
.f-btn.active{background:var(--main);color:#fff}

.catalog{display:grid;grid-template-columns:1fr 1fr;gap:10px;padding:10px}
.card{background:#fff;border-radius:15px;padding:10px;border:4px solid transparent;transition:0.3s}
.card img{width:100%;height:140px;object-fit:cover;border-radius:10px}
.card-id{font-size:10px;color:#aaa;margin-top:5px}

/* –†–∞–º–∫–∏ –∑–∞ —Ü—ñ–Ω–æ—é */
.r-black{border-color:#000} .r-gray{border-color:var(--gray)} .r-blue{border-color:#3498db}
.r-yellow{border-color:#f1c40f} .r-red{border-color:#e74c3c} .r-green{border-color:#2ecc71}
.r-purple{border-color:#9b59b6} .r-gold{border-color:var(--gold);box-shadow:0 0 10px var(--gold)}

/* –ú–æ–¥–∞–ª–∫–∞ –ø–µ—Ä–µ–≥–ª—è–¥—É */
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.9);z-index:1000;justify-content:center;align-items:center}
.modal.show{display:flex}
.m-cont{background:#fff;width:95%;max-width:400px;border-radius:20px;display:flex;flex-direction:column;position:relative;max-height:90vh;overflow:hidden}
.slider{display:flex;overflow-x:auto;scroll-snap-type:x mandatory;height:280px;background:#000;flex-shrink:0}
.slider img{width:100%;height:100%;object-fit:contain;scroll-snap-align:start;flex-shrink:0}
.m-body{padding:20px;overflow-y:auto;flex-grow:1}
.close-x{position:absolute;top:10px;right:15px;font-size:35px;cursor:pointer;color:#fff;z-index:20;text-shadow:0 0 5px #000}

.order-footer{background:var(--main);color:#fff;padding:15px;border-radius:12px;text-align:center;margin-top:15px}
.order-footer a{color:#fff;text-decoration:none;font-weight:bold;font-size:18px}
</style>
</head>
<body>

<div class="top-contact">–∑–∞–º–æ–≤–∏—Ç–∏ üëá <a href="tel:+380XXXXXXXXX">+380XXXXXXXXX</a></div>

<header>
  <h2 style="margin:0">SHOP-NAME.UA</h2>
  <div class="plus-btn" onclick="openAdmin()">+</div>
</header>

<div class="controls">
  <input type="text" id="srch" placeholder="–ü–æ—à—É–∫ –∑–∞ –Ω–∞–∑–≤–æ—é –∞–±–æ ID..." style="padding:12px;border-radius:10px;border:1px solid #ddd">
  <div class="filters">
    <button class="f-btn active" onclick="filterP(0,999999,this)">–í—Å—ñ</button>
    <button class="f-btn" onclick="filterP(100,200,this)">100-200</button>
    <button class="f-btn" onclick="filterP(201,500,this)">201-500</button>
    <button class="f-btn" onclick="filterP(501,1000,this)">501-1000</button>
    <button class="f-btn" onclick="filterP(1001,2000,this)">1001-2000</button>
    <button class="f-btn" onclick="filterP(2001,999999,this)">2000+</button>
  </div>
</div>

<div class="catalog" id="cat"></div>

<div id="mView" class="modal">
  <div class="m-cont">
    <div class="close-x" onclick="closeM()">√ó</div>
    <div class="slider" id="vSlider"></div>
    <div class="m-body">
        <h2 id="vt" style="margin:0"></h2>
        <div id="vp" style="color:var(--main);font-size:24px;font-weight:bold;margin:10px 0"></div>
        <div id="vid" style="font-size:11px;color:#aaa;margin-bottom:15px;border-bottom:1px solid #eee;padding-bottom:5px"></div>
        <div id="vd" style="line-height:1.6;color:#333"></div>
        
        <div class="order-footer">
            <div>–∑–∞–º–æ–≤–ª—è–π —Ç—É—Ç –ø–æ–∫–∏ —î –≤ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ üëá</div>
            <a href="tel:+380XXXXXXXXX">+380XXXXXXXXX</a>
        </div>
        <button id="delB" style="width:100%;margin-top:20px;color:red;border:1px solid red;background:none;padding:10px;border-radius:10px;display:none">–í–∏–¥–∞–ª–∏—Ç–∏ —Ç–æ–≤–∞—Ä</button>
    </div>
  </div>
</div>

<div id="mAdmin" class="modal">
  <div class="m-cont" style="padding:20px">
    <div id="boxLogin">
        <h3>–í—Ö—ñ–¥ (xxxshop)</h3>
        <input type="password" id="code" placeholder="–ö–æ–¥" style="width:96%;margin-bottom:10px;padding:10px">
        <button onclick="login()" style="width:100%;background:#2ecc71;color:#fff;border:none;padding:12px;border-radius:10px">–£–≤—ñ–π—Ç–∏</button>
    </div>
    <div id="boxAdd" style="display:none; flex-direction:column; gap:8px">
        <h3>–î–æ–¥–∞—Ç–∏ —Ç–æ–≤–∞—Ä</h3>
        <input type="text" id="t" placeholder="–ù–∞–∑–≤–∞">
        <input type="number" id="p" placeholder="–¶—ñ–Ω–∞">
        <textarea id="d" placeholder="–û–ø–∏—Å" style="height:80px;padding:10px"></textarea>
        <p style="margin:0;font-size:12px">–î–æ–¥–∞–π –¥–æ 5 —Ñ–æ—Ç–æ:</p>
        <input type="file" class="img-in" accept="image/*" multiple>
        <button id="btnS" style="background:#2ecc71;color:#fff;border:none;padding:12px;border-radius:10px" onclick="save()">üöÄ –û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏</button>
    </div>
    <button onclick="closeM()" style="margin-top:10px;background:none;border:none;color:#888">–ó–∞–∫—Ä–∏—Ç–∏</button>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
import { getDatabase, ref, push, set, onValue, remove } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js";

const conf = {
  apiKey: "AIzaSyD3BQTZeCp74owFliqECbUgufJ3UC6dFC8",
  authDomain: "vip-shop-a2ec4.firebaseapp.com",
  projectId: "vip-shop-a2ec4",
  databaseURL: "https://vip-shop-a2ec4-default-rtdb.firebaseio.com",
  appId: "1:429877342673:web:bf2fbcddd5f3ba04c670f0"
};

const app = initializeApp(conf);
const db = getDatabase(app);
let isAdmin = false, all = [];

window.closeM = () => { document.querySelectorAll('.modal').forEach(m=>m.classList.remove('show')); };
window.openAdmin = () => { document.getElementById('mAdmin').classList.add('show'); };

window.login = () => {
  if(document.getElementById('code').value === 'xxxshop') {
    isAdmin = true;
    document.getElementById('boxLogin').style.display='none';
    document.getElementById('boxAdd').style.display='flex';
  } else alert('–ù–µ–≤—ñ—Ä–Ω–æ!');
};

const getR = (p) => {
    if(p >= 2001) return 'r-gold'; if(p >= 1500) return 'r-purple';
    if(p >= 1000) return 'r-green'; if(p >= 700) return 'r-red';
    if(p >= 400) return 'r-yellow'; if(p >= 200) return 'r-blue';
    if(p >= 100) return 'r-gray'; return 'r-black';
};

const render = (items) => {
  const cat = document.getElementById('cat');
  cat.innerHTML = '';
  items.forEach(i => {
    const div = document.createElement('div');
    div.className = `card ${getR(i.price)}`;
    div.innerHTML = `<img src="${i.imgs ? i.imgs[0] : i.img}"><div style="font-weight:bold;margin-top:8px">${i.price} –≥—Ä–Ω</div>
                     <div style="font-size:13px">${i.title}</div>
                     <div class="card-id">ID: ${i.id.substring(1,7)}</div>`;
    div.onclick = () => {
      const slider = document.getElementById('vSlider');
      slider.innerHTML = (i.imgs || [i.img]).map(src => `<img src="${src}">`).join('');
      document.getElementById('vt').innerText = i.title;
      document.getElementById('vp').innerText = i.price + ' –≥—Ä–Ω';
      document.getElementById('vd').innerText = i.desc || '';
      document.getElementById('vid').innerText = '–ê–†–¢–ò–ö–£–õ: ' + i.id.toUpperCase();
      
      const dbnt = document.getElementById('delB');
      dbnt.style.display = isAdmin ? 'block' : 'none';
      dbnt.onclick = () => {
          if(prompt('–í–≤–µ–¥—ñ—Ç—å –∫–æ–¥ –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è:') === 'xxxshop') {
              remove(ref(db, 'products/'+i.id)); closeM();
          }
      };
      document.getElementById('mView').classList.add('show');
    };
    cat.appendChild(div);
  });
};

onValue(ref(db, 'products'), s => {
  const d = s.val();
  all = d ? Object.keys(d).map(id => ({ id, ...d[id] })) : [];
  render(all);
});

window.save = async () => {
  const title = document.getElementById('t').value, price = +document.getElementById('p').value;
  const desc = document.getElementById('d').value, files = document.querySelector('.img-in').files;
  if(!title || !price || files.length === 0) return alert('–ó–∞–ø–æ–≤–Ω—ñ—Ç—å –Ω–∞–∑–≤—É, —Ü—ñ–Ω—É —Ç–∞ –¥–æ–¥–∞–π—Ç–µ —Ö–æ—á–∞ –± 1 —Ñ–æ—Ç–æ!');
  
  document.getElementById('btnS').innerText = '–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–æ—Ç–æ...';
  const uploadedUrls = [];
  
  for(let file of Array.from(files).slice(0,5)) {
      const fd = new FormData(); fd.append('image', file);
      const r = await fetch('https://api.imgbb.com/1/upload?key=03c26bf2c4e95bbd1e544d9d2cad9672', {method:'POST', body:fd});
      const res = await r.json();
      uploadedUrls.push(res.data.url);
  }

  set(push(ref(db, 'products')), { title, price, desc, imgs: uploadedUrls });
  closeM();
  document.getElementById('btnS').innerText = 'üöÄ –û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏';
};

window.filterP = (min, max, btn) => {
    document.querySelectorAll('.f-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    render(all.filter(i => i.price >= min && i.price <= max));
};

document.getElementById('srch').oninput = e => {
  const q = e.target.value.toLowerCase();
  render(all.filter(i => i.title.toLowerCase().includes(q) || i.id.toLowerCase().includes(q)));
};
</script>
</body>
</html>
