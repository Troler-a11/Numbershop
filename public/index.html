<!doctype html>
<html lang="uk">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ULTRA SHOP</title>
<style>
:root{--main:#ff4757;--dark:#2f3542;--light:#f1f2f6;--gold:#ffd700}
body{font-family:'Segoe UI',sans-serif;background:var(--light);margin:0;padding-bottom:50px}

header{background:#fff;padding:15px;text-align:center;box-shadow:0 2px 5px rgba(0,0,0,.1);position:sticky;top:0;z-index:100}
.plus-btn{position:absolute;right:20px;top:15px;font-size:24px;cursor:pointer;color:var(--main);font-weight:bold}

.controls{padding:10px;display:flex;flex-direction:column;gap:8px}
input,textarea,button{padding:12px;border-radius:10px;border:1px solid #ddd;outline:none}
.filters{display:flex;gap:5px;overflow-x:auto;padding:5px}
.f-btn{background:#fff;border:1px solid var(--main);padding:6px 12px;border-radius:20px;white-space:nowrap;font-size:12px;cursor:pointer}
.f-btn.active{background:var(--main);color:#fff}

.catalog{display:grid;grid-template-columns:1fr 1fr;gap:10px;padding:10px}
.card{background:#fff;border-radius:12px;padding:8px;box-shadow:0 2px 4px rgba(0,0,0,.05);border:4px solid transparent;position:relative;transition:0.3s}
.card img{width:100%;height:130px;object-fit:cover;border-radius:8px}
.price{color:var(--main);font-weight:bold;font-size:16px;margin:5px 0}
.card-id{font-size:10px;color:#aaa;text-transform:uppercase}

/* –†–∞–º–∫–∏ –∑–∞ —Ü—ñ–Ω–æ—é */
.r-black{border-color:#000}
.r-gray{border-color:#888} /* –ó–∞–º—ñ—Å—Ç—å –±—ñ–ª–æ–≥–æ - —Å—ñ—Ä–∏–π */
.r-blue{border-color:#3498db}
.r-yellow{border-color:#f1c40f}
.r-red{border-color:#e74c3c}
.r-green{border-color:#2ecc71}
.r-purple{border-color:#9b59b6}
.r-gold{border-color:var(--gold);box-shadow:0 0 15px var(--gold);animation:glow 1s infinite alternate}
@keyframes glow{from{opacity:0.8}to{opacity:1}}

.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.85);z-index:1000;justify-content:center;align-items:center}
.modal.show{display:flex}
.m-cont{background:#fff;width:90%;max-width:380px;padding:20px;border-radius:20px;display:flex;flex-direction:column;gap:12px;position:relative;max-height:90vh;overflow-y:auto}

.close-x{position:absolute;top:10px;right:15px;font-size:30px;cursor:pointer;color:#333;z-index:10;font-weight:bold}
.v-img-wrap{border:4px solid #eee;border-radius:15px;overflow:hidden;line-height:0}
.order-footer{background:var(--main);color:#fff;padding:15px;border-radius:12px;text-align:center;margin-top:10px}
.order-footer a{color:#fff;text-decoration:none;font-weight:bold;font-size:18px;display:block;margin-top:5px}
</style>
</head>
<body>

<header>
  <h2 style="margin:0">BRAND-NAME.UA</h2>
  <div class="plus-btn" onclick="openAdmin()">+</div>
</header>

<div class="controls">
  <input type="text" id="srch" placeholder="–ü–æ—à—É–∫ –∑–∞ ID –∞–±–æ –Ω–∞–∑–≤–æ—é...">
  <div class="filters">
    <button class="f-btn active" onclick="filterP(0,999999,this)">–í—Å—ñ</button>
    <button class="f-btn" onclick="filterP(1,99,this)">1-99</button>
    <button class="f-btn" onclick="filterP(100,500,this)">100-500</button>
    <button class="f-btn" onclick="filterP(501,1000,this)">501-1000</button>
    <button class="f-btn" onclick="filterP(1001,2000,this)">1001-2000</button>
    <button class="f-btn" onclick="filterP(2001,999999,this)">2000+</button>
  </div>
</div>

<div class="catalog" id="cat"></div>

<div id="mAdmin" class="modal">
  <div class="m-cont" id="boxLogin">
    <div class="close-x" onclick="closeM()">√ó</div>
    <h3>–í—Ö—ñ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h3>
    <input type="password" id="code" placeholder="–°–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–æ–¥">
    <button style="background:#2ecc71;color:#fff;border:none" onclick="login()">–£–≤—ñ–π—Ç–∏</button>
  </div>
  <div class="m-cont" id="boxAdd" style="display:none">
    <div class="close-x" onclick="closeM()">√ó</div>
    <h3>–î–æ–¥–∞—Ç–∏ —Ç–æ–≤–∞—Ä</h3>
    <input type="text" id="t" placeholder="–ù–∞–∑–≤–∞">
    <input type="number" id="p" placeholder="–¶—ñ–Ω–∞">
    <textarea id="d" placeholder="–û–ø–∏—Å —Ç–æ–≤–∞—Ä—É"></textarea>
    <input type="file" id="f" accept="image/*">
    <button id="btnS" style="background:#2ecc71;color:#fff;border:none" onclick="save()">üöÄ –û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏</button>
  </div>
</div>

<div id="mView" class="modal">
  <div class="m-cont">
    <div class="close-x" onclick="closeM()">√ó</div>
    <div class="v-img-wrap" id="vWrap">
        <img id="vi" style="width:100%">
    </div>
    <h2 id="vt" style="margin:10px 0 0"></h2>
    <div id="vp" style="color:var(--main);font-size:24px;font-weight:bold"></div>
    <div id="vid" style="font-size:11px;color:#aaa;margin-bottom:10px"></div>
    <div id="vd" style="line-height:1.6;color:#444;border-top:1px solid #eee;padding-top:10px"></div>
    
    <div class="order-footer">
        <div>–∑–∞–º–æ–≤–ª—è–π —Ç—É—Ç –ø–æ–∫–∏ —î –≤ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ üëá</div>
        <a href="tel:+380XXXXXXXXX">+380XXXXXXXXX</a>
    </div>
    <button id="delB" style="background:#fefefe;border:1px solid #ddd;color:red;margin-top:10px;display:none;padding:5px;border-radius:8px;cursor:pointer">üóë –í–∏–¥–∞–ª–∏—Ç–∏ —Ç–æ–≤–∞—Ä</button>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
import { getDatabase, ref, push, set, onValue, remove } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js";

const conf = {
  apiKey: "AIzaSyD3BQTZeCp74owFliqECbUgufJ3UC6dFC8",
  authDomain: "vip-shop-a2ec4.firebaseapp.com",
  projectId: "vip-shop-a2ec4",
  databaseURL: "https://vip-shop-a2ec4-default-rtdb.firebaseio.com",
  appId: "1:429877342673:web:bf2fbcddd5f3ba04c670f0"
};

const app = initializeApp(conf);
const db = getDatabase(app);
let isAdmin = false, all = [];
const IMGBB = '03c26bf2c4e95bbd1e544d9d2cad9672';

window.closeM = () => { document.querySelectorAll('.modal').forEach(m=>m.classList.remove('show')); };
window.openAdmin = () => { document.getElementById('mAdmin').classList.add('show'); };

window.login = () => {
  if(document.getElementById('code').value === 'xxxshop') {
    isAdmin = true;
    document.getElementById('boxLogin').style.display='none';
    document.getElementById('boxAdd').style.display='flex';
  } else alert('–ö–æ–¥ –Ω–µ–≤—ñ—Ä–Ω–∏–π!');
};

const getR = (p) => {
    if(p >= 2001) return 'r-gold';
    if(p >= 1500) return 'r-purple';
    if(p >= 1000) return 'r-green';
    if(p >= 700) return 'r-red';
    if(p >= 400) return 'r-yellow';
    if(p >= 200) return 'r-blue';
    if(p >= 100) return 'r-gray'; /* –ó–º—ñ–Ω–µ–Ω–æ –Ω–∞ —Å—ñ—Ä–∏–π */
    return 'r-black';
};

const render = (items) => {
  const cat = document.getElementById('cat');
  cat.innerHTML = '';
  items.forEach(i => {
    const div = document.createElement('div');
    div.className = `card ${getR(i.price)}`;
    div.innerHTML = `
        <img src="${i.img}">
        <div class="price">${i.price} –≥—Ä–Ω</div>
        <div style="font-size:13px;font-weight:bold">${i.title}</div>
        <div class="card-id">ID: ${i.id.substring(1,7)}</div>
    `;
    div.onclick = () => {
      document.getElementById('vi').src = i.img;
      document.getElementById('vt').innerText = i.title;
      document.getElementById('vp').innerText = i.price + ' –≥—Ä–Ω';
      document.getElementById('vd').innerText = i.desc || '–û–ø–∏—Å –Ω–µ –≤–∫–∞–∑–∞–Ω–æ';
      document.getElementById('vid').innerText = '–ê–†–¢–ò–ö–£–õ: ' + i.id.toUpperCase();
      document.getElementById('vWrap').className = 'v-img-wrap ' + getR(i.price);
      
      const dbnt = document.getElementById('delB');
      dbnt.style.display = isAdmin ? 'block' : 'none';
      dbnt.onclick = () => {
          const verify = prompt('–î–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è –≤–≤–µ–¥—ñ—Ç—å –∞–¥–º—ñ–Ω-–∫–æ–¥ —â–µ —Ä–∞–∑:');
          if(verify === 'xxxshop') {
              if(confirm('–í–∏ —Ç–æ—á–Ω–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü–µ–π —Ç–æ–≤–∞—Ä?')) {
                  remove(ref(db, 'products/'+i.id)); 
                  closeM();
              }
          } else {
              alert('–ù–µ–≤—ñ—Ä–Ω–∏–π –∫–æ–¥! –í–∏–¥–∞–ª–µ–Ω–Ω—è —Å–∫–∞—Å–æ–≤–∞–Ω–æ.');
          }
      };
      document.getElementById('mView').classList.add('show');
    };
    cat.appendChild(div);
  });
};

onValue(ref(db, 'products'), s => {
  const d = s.val();
  all = d ? Object.keys(d).map(id => ({ id, ...d[id] })) : [];
  render(all);
});

window.save = async () => {
  const title = document.getElementById('t').value, price = +document.getElementById('p').value;
  const desc = document.getElementById('d').value, file = document.getElementById('f').files[0];
  if(!title || price < 5 || !file) return alert('–ó–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è! –¶—ñ–Ω–∞ –º—ñ–Ω. 5 –≥—Ä–Ω.');
  
  document.getElementById('btnS').innerText = '‚è≥ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...';
  const fd = new FormData(); fd.append('image', file);
  try {
    const r = await fetch('https://api.imgbb.com/1/upload?key=' + IMGBB, {method:'POST', body:fd});
    const res = await r.json();
    set(push(ref(db, 'products')), { title, price, desc, img: res.data.url });
    closeM();
    document.getElementById('t').value=''; document.getElementById('p').value=''; document.getElementById('d').value='';
  } catch(e) { alert('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è!'); }
  finally { document.getElementById('btnS').innerText = 'üöÄ –û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏'; }
};

window.filterP = (min, max, btn) => {
  document.querySelectorAll('.f-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  render(all.filter(i => i.price >= min && i.price <= max));
};

document.getElementById('srch').oninput = e => {
  const q = e.target.value.toLowerCase().trim();
  render(all.filter(i => i.title.toLowerCase().includes(q) || i.id.toLowerCase().includes(q)));
};
</script>
</body>
</html>
