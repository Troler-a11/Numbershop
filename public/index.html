<!doctype html>
<html lang="uk">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>SHOP UA</title>
<style>
:root{--main:#ff4757;--dark:#2f3542;--light:#f1f2f6;--gold:#ffd700}
body{font-family:sans-serif;background:var(--light);margin:0;padding-bottom:50px}
header{background:#fff;padding:15px;text-align:center;box-shadow:0 2px 5px rgba(0,0,0,.1);position:sticky;top:0;z-index:100}
.plus-btn{position:absolute;right:20px;top:15px;font-size:24px;cursor:pointer;color:var(--main)}
.controls{padding:10px;display:flex;flex-direction:column;gap:8px}
input,textarea,button{padding:12px;border-radius:10px;border:1px solid #ddd;outline:none}
.filters{display:flex;gap:5px;overflow-x:auto;padding:5px}
.f-btn{background:#fff;border:1px solid var(--main);padding:6px 12px;border-radius:20px;white-space:nowrap;font-size:12px}
.f-btn.active{background:var(--main);color:#fff}
.catalog{display:grid;grid-template-columns:1fr 1fr;gap:10px;padding:10px}
.card{background:#fff;border-radius:12px;padding:8px;box-shadow:0 2px 4px rgba(0,0,0,.05);border:3px solid transparent}
.card img{width:100%;height:130px;object-fit:cover;border-radius:8px}
.price{color:var(--main);font-weight:bold;font-size:16px;margin:5px 0}
/* Рамки */
.b-gold{border-color:var(--gold);box-shadow:0 0 10px var(--gold)}
.b-high{border-color:#ffa502}
.b-mid{border-color:#70a1ff}
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.8);z-index:1000;justify-content:center;align-items:center}
.modal.show{display:flex}
.m-cont{background:#fff;width:90%;max-width:350px;padding:20px;border-radius:15px;display:flex;flex-direction:column;gap:10px}
</style>
</head>
<body>

<header>
  <h2 style="margin:0">BRAND-NAME.UA</h2>
  <div class="plus-btn" onclick="openAdmin()">+</div>
</header>

<div class="controls">
  <input type="text" id="srch" placeholder="Пошук за ID або назвою...">
  <div class="filters">
    <button class="f-btn active" onclick="filterP(0,99999,this)">Всі</button>
    <button class="f-btn" onclick="filterP(1,99,this)">1-99</button>
    <button class="f-btn" onclick="filterP(100,1000,this)">100-1000</button>
    <button class="f-btn" onclick="filterP(1001,2000,this)">1001-2000</button>
    <button class="f-btn" onclick="filterP(2001,99999,this)">2000+</button>
  </div>
</div>

<div class="catalog" id="cat"></div>

<div id="mAdmin" class="modal">
  <div class="m-cont" id="boxLogin">
    <h3>Вхід</h3>
    <input type="password" id="code" placeholder="Код">
    <button style="background:#2ecc71;color:#fff;border:none" onclick="login()">Увійти</button>
    <button onclick="closeM()">Закрити</button>
  </div>
  <div class="m-cont" id="boxAdd" style="display:none">
    <h3>Новий товар</h3>
    <input type="text" id="t" placeholder="Назва">
    <input type="number" id="p" placeholder="Ціна">
    <textarea id="d" placeholder="Опис"></textarea>
    <input type="file" id="f" accept="image/*">
    <button id="btnS" style="background:#2ecc71;color:#fff;border:none" onclick="save()">Зберегти</button>
    <button onclick="closeM()">Закрити</button>
  </div>
</div>

<div id="mView" class="modal" onclick="closeM()">
  <div class="m-cont" onclick="event.stopPropagation()">
    <img id="vi" style="width:100%;border-radius:10px">
    <h3 id="vt" style="margin:10px 0 5px"></h3>
    <div id="vp" style="color:var(--main);font-weight:bold;font-size:20px"></div>
    <p id="vd" style="font-size:14px;color:#555"></p>
    <button id="delB" style="background:red;color:#fff;border:none;display:none">Видалити</button>
    <button onclick="closeM()">Закрити</button>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
import { getDatabase, ref, push, set, onValue, remove } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js";

const conf = {
  apiKey: "AIzaSyD3BQTZeCp74owFliqECbUgufJ3UC6dFC8",
  authDomain: "vip-shop-a2ec4.firebaseapp.com",
  projectId: "vip-shop-a2ec4",
  databaseURL: "https://vip-shop-a2ec4-default-rtdb.firebaseio.com",
  appId: "1:429877342673:web:bf2fbcddd5f3ba04c670f0"
};

const app = initializeApp(conf);
const db = getDatabase(app);
let isAdmin = false, all = [];

window.closeM = () => { document.querySelectorAll('.modal').forEach(m=>m.classList.remove('show')); };
window.openAdmin = () => { document.getElementById('mAdmin').classList.add('show'); };

window.login = () => {
  if(document.getElementById('code').value === 'xxxshop') {
    isAdmin = true;
    document.getElementById('boxLogin').style.display='none';
    document.getElementById('boxAdd').style.display='flex';
  } else alert('Невірно!');
};

const render = (items) => {
  const cat = document.getElementById('cat');
  cat.innerHTML = '';
  items.forEach(i => {
    const div = document.createElement('div');
    let bc = ''; 
    if(i.price >= 2001) bc = 'b-gold';
    else if(i.price >= 1001) bc = 'b-high';
    else if(i.price >= 500) bc = 'b-mid';
    
    div.className = `card ${bc}`;
    div.innerHTML = `<img src="${i.img}"><div class="price">${i.price} грн</div><div style="font-size:13px">${i.title}</div>`;
    div.onclick = () => {
      document.getElementById('vi').src = i.img;
      document.getElementById('vt').innerText = i.title;
      document.getElementById('vp').innerText = i.price + ' грн';
      document.getElementById('vd').innerText = i.desc || '';
      const dbnt = document.getElementById('delB');
      dbnt.style.display = isAdmin ? 'block' : 'none';
      dbnt.onclick = () => { if(confirm('Видалити?')) { remove(ref(db, 'products/'+i.id)); closeM(); } };
      document.getElementById('mView').classList.add('show');
    };
    cat.appendChild(div);
  });
};

onValue(ref(db, 'products'), s => {
  const d = s.val();
  all = d ? Object.keys(d).map(id => ({ id, ...d[id] })) : [];
  render(all);
});

window.save = async () => {
  const title = document.getElementById('t').value, price = +document.getElementById('p').value;
  const desc = document.getElementById('d').value, file = document.getElementById('f').files[0];
  if(!title || price < 5 || !file) return alert('Ціна < 5 або поля пусті!');
  
  document.getElementById('btnS').innerText = 'Завантаження...';
  const fd = new FormData(); fd.append('image', file);
  const r = await fetch('https://api.imgbb.com/1/upload?key=03c26bf2c4e95bbd1e544d9d2cad9672', {method:'POST', body:fd});
  const res = await r.json();
  set(push(ref(db, 'products')), { title, price, desc, img: res.data.url });
  closeM();
  document.getElementById('btnS').innerText = 'Зберегти';
};

window.filterP = (min, max, btn) => {
  document.querySelectorAll('.f-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  render(all.filter(i => i.price >= min && i.price <= max));
};

document.getElementById('srch').oninput = e => {
  const q = e.target.value.toLowerCase();
  render(all.filter(i => i.title.toLowerCase().includes(q) || i.id.toLowerCase().includes(q)));
};
</script>
</body>
</html>

